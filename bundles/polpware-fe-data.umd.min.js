!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@polpware/fe-dependencies"),require("@polpware/fe-utilities"),require("@ngrx/store"),require("@angular/core")):"function"==typeof define&&define.amd?define("@polpware/fe-data",["exports","@polpware/fe-dependencies","@polpware/fe-utilities","@ngrx/store","@angular/core"],t):t(((e=e||self).polpware=e.polpware||{},e.polpware["fe-data"]={}),e.feDependencies,e.feUtilities,e.store,e.ng.core)}(this,(function(e,t,n,r,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var l=t.backbone,h=t.underscore,d=t.constraintjs,y=function(){function e(e,t){var n=this;if(this.dummyRecords=t,this._name=e.name,this._cascade=!1,this._foreignRelation={},this._reverseForeignRelation={},e.dataProviderCtor)this._dataProvider=new e.dataProviderCtor;else{var r=l.Collection.extend(e.dataProviderCtorOption||{});this._dataProvider=new r}this._addConstraint=d.constraint([]),this._deleteConstraint=d.constraint([]),this._onDeletedHandler=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.onDeleted()},this._deleteConstraint.onChange(this._onDeletedHandler)}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cascade",{get:function(){return this._cascade},enumerable:!0,configurable:!0}),e.prototype.dataProvider=function(){return this._dataProvider},e.prototype.onDeleted=function(){},e.prototype.hasAnyReference=function(e){if(!this._dataProvider.get(e.id))return!1;var t=this._reverseForeignRelation,n=!1,r=function(r){if(t.hasOwnProperty(r)){var o=t[r];if(n=h.some(o,(function(t){var n=t.dataProvider(),o={};return o[r]=e.id,!!n.findWhere(o)})))return"break"}};for(var o in t){if("break"===r(o))break}return n},e.prototype.removeReverseForeign=function(e){var t=this._reverseForeignRelation,r=function(r){t.hasOwnProperty(r)&&t[r].forEach((function(t){var o=t.dataProvider(),i=[];e.forEach((function(e){var t={};t[r]=e.id;var a=o.where(t);n.pushArray(i,a)})),i.forEach((function(e){e.destroyFromTable()}))}))};for(var o in t)r(o)},e.prototype.get=function(e){return this._dataProvider.get(e)},e.prototype.destroyFromTable=function(e){var t=this._dataProvider.remove(e);t&&(t.set("invalidated",!0),t.trigger("destroy",t),this.removeReverseForeign([t]))},e.prototype.getForeignModel=function(e,t){var n=e.attributes[t];return n?this._foreignRelation[t].dataProvider().get(n):this.dummyRecords.getDummyRecord(t)},e.prototype.add=function(e){var t=this,n=this._dataProvider,r=(this._foreignRelation,n.modelId(e)),o=n.get(r);if(o){var i=h.extend({},o.attributes,e);return o.set(i),o}return(o=n.add(e)).destroyFromTable=function(){t.destroyFromTable(this)},o.getForeignModel=function(e){return t.getForeignModel(this,e)},o.hasAnyReference=function(){return t.hasAnyReference(this)},o},e.prototype.addMany=function(e){var t=this;return e.map((function(e){return t.add(e)}))},e.prototype.addForeignRelation=function(e,t){if(this._foreignRelation[e])throw new Error("Foreign key exists: "+e);this._foreignRelation[e]=t},e.prototype.addReverseForeignRelation=function(e,t){var n=this._reverseForeignRelation[e];if(n){if(-1!==n.findIndex((function(e){return e===t})))throw new Error("Reverse foreign table exists: "+e);n.push(t)}else this._reverseForeignRelation[e]=[t]},e.prototype.hasForeignRelation=function(e){return!!this._foreignRelation[e]},e.prototype.hasReverseForeignRelation=function(e){return!!this._reverseForeignRelation[e]},e.prototype.destroy=function(){this._deleteConstraint.offChange(this._onDeletedHandler),this._dataProvider.reset()},e}(),v=t.backbone,g=function(){function e(){this._data={}}return e.prototype.getDummyRecord=function(e){return this._data[e]||(this._data[e]=new v.Model({})),this._data[e]},e}(),_=function(){function e(){this._referenceCounter=1,this._tableCollection={},this._dummyRecords=new g}return e.prototype.getReference=function(){return this._referenceCounter++,this},e.prototype.addTable=function(e){return this._tableCollection[e.name]=new y(e,this._dummyRecords)},e.prototype.getTable=function(e){return this._tableCollection[e]},e.prototype.addForeignkey=function(e,t,n){var r=this._tableCollection[e];if(!r)throw new Error("Undefined table: "+e);var o=this._tableCollection[n];if(!o)throw new Error("Undefined foreign table: "+n);r.addForeignRelation(t,o),o.addReverseForeignRelation(t,r)},e.prototype.destroy=function(){if(this._referenceCounter--,0===this._referenceCounter){for(var e in this._tableCollection){if(this._tableCollection.hasOwnProperty(e))this._tableCollection[e].destroy()}this._tableCollection={}}},e}(),m=t.XHR,b=t.underscore,P={async:!0,content_type:"",response_type:"json",requestheaders:[],success_scope:null,error_scope:null,scope:null};
/**
     * @fileOverview
     * Provides a bunch of utilties on network communication.
     * @name Curl.js
     * @module hypercom/util/Curl
     * @author Xiaolong Tang <xxlongtang@gmail.com>
     * @license Copyright @me
     */
var w=t.Tools,x=t.jquery;function O(e){return x.ajax({url:e,cache:!0,dataType:"json"})}var E=function(){function e(){this._store={}}return e.prototype.set=function(e,t){return this._store[e]=t,t},e.prototype.get=function(e){return this._store[e]||null},e.prototype.remove=function(e){delete this._store[e]},e.prototype.length=function(e){return Object.keys(this._store).length},e.prototype.key=function(e){var t=Object.keys(this._store);return e>=0&&e<t.length?t[e]:""},e.prototype.enabled=function(){return!0},e}(),k=t.EventDispatcher,T=function(e){return e._eventDispatcher||(e._eventDispatcher=new k({scope:e,toggleEvent:function(t,n){k.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher};function I(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.fire=function(e,t,n){if(this.removed&&"remove"!==e)return null;var r=T(this).fire(e,t,n);if(!1!==n&&this.parent)for(var o=this.parent();o&&!r.isPropagationStopped();)o.fire(e,r,!1),o=o.parent();return r},t.prototype.on=function(e,t,n){return T(this).on(e,t,n)},t.prototype.off=function(e,t){return T(this).off(e,t)},t.prototype.once=function(e,t){return T(this).once(e,t)},t.prototype.hasEventListeners=function(e){return T(this).has(e)},t}(e)}var R=t.locache,j=t.meld,C=Object.getPrototypeOf(R.locache).remove,F=function(){return(new Date).getTime()},S=function(){function e(e,t,n){var r=this;this._defaultSeconds=e;var o=new E;this._cache=R.locache.createCache({storage:o}),this._cache.remove=j.around(C,(function(e){var t=e.args[0],n=r.onExpireEventName(t);if(r.asObservable.fire(n,{}).isDefaultPrevented())return r.resetExpireKey(t,r._defaultSeconds),!1;r.asObservable.off(n,null),e.proceed();var o=r.afterRemoveEventName(t);return r.asObservable.fire(o,{}),!0})),t?n?n.runOutsideAngular((function(){r._timeInterval=setInterval((function(){r._cache.cleanup()}),1e3*t)})):this._timeInterval=setInterval((function(){r._cache.cleanup()}),1e3*t):this._timeInterval=null}return e.prototype.onExpireEventName=function(e){return"onExpire:"+e},e.prototype.afterRemoveEventName=function(e){return"afterRemove:"+e},e.prototype.resetExpireKey=function(e,t){var n=this._cache.expirekey(e),r=1e3*t;this._cache.storage.set(n,F()+r)},Object.defineProperty(e.prototype,"asObservable",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t,n,r){var o=this._cache.expirekey(e),i=this._cache.key(e);if(n){var a=1e3*n;this._cache.storage.set(o,F()+a)}else this._cache.storage.remove(o);return r&&this.asObservable.once(this.afterRemoveEventName(e),r),this._cache.storage.set(i,t)},e.prototype.get=function(e,t){if(this._cache.hasExpired(e)&&this._cache.remove(e))return null;var n=this._cache.key(e),r=this._cache.storage.get(n);return r&&this.resetExpireKey(e,t||this._defaultSeconds),r},e.prototype.invalidate=function(e){var t=this._cache.keys()||[];t=t.filter((function(t){return-1!==t.indexOf(e)})),this.resetInternal(t)},e.prototype.rmOnExpireHandler=function(e,t){this.asObservable.off(this.onExpireEventName(e),t)},e.prototype.addOnExpireHandler=function(e,t){this.asObservable.on(this.onExpireEventName(e),t)},Object.defineProperty(e.prototype,"count",{get:function(){return this._cache.length()},enumerable:!0,configurable:!0}),e.prototype.reset=function(){var e=this._cache.keys()||[];this.resetInternal(e)},e.prototype.resetInternal=function(e){var t=this;e.forEach((function(e){t.asObservable.off(t.onExpireEventName(e),null),C.call(t._cache,e),t.asObservable.fire(t.afterRemoveEventName(e),{})}))},e.prototype.destroy=function(){this.reset(),this._timeInterval&&clearInterval(this._timeInterval)},e.ctorParameters=function(){return[{type:Number},{type:Number},{type:void 0}]},e=c([I,u("design:paramtypes",[Number,Number,Object])],e)}(),N={url:"dummy",clientId:"dummy",clientSecret:"dummy",scope:"all"},D=t.underscore,A=function(){function e(e){this.url=e.url,this.token=""}return e.prototype.getTokenP=function(){var e=this;return D.isEmpty(this.token)||this.isExpired()?this.getTokenInternal().then((function(t){return e.token=t})):n.lift(this.token,null)},e.prototype.reset=function(){this.token=""},e}(),K=(t.underscore,t.jquery);function M(e){return(e=e||{}).expiresIn=e.expiresIn||0,e.createdOn=e.createdOn||0,e.token=e.token||"",e.refreshToken=e.refreshToken||"",e}var q=function(e){function t(t){var n=e.call(this,t)||this;return n.clientId=t.clientId,n.clientSecret=t.clientSecret,n.scope=t.scope,n.expiresIn=null,n.createdOn=null,n.refreshToken="",n.response=null,n}return a(t,e),t.prototype.readFrom=function(e){this.expiresIn=e.expiresIn,this.createdOn=e.createdOn,this.token=e.token,this.refreshToken=e.refreshToken},t.prototype.persistent=function(){return{expiresIn:this.expiresIn,createdOn:this.createdOn,token:this.token,refreshToken:this.refreshToken}},t.prototype.getParams=function(){return{client_id:this.clientId,client_secret:this.clientSecret,scope:this.scope,grant_type:this.grantType}},t.prototype.getTokenInternal=function(){var e=this,t=this.getParams();return K.ajax({url:this.url,data:t,method:"POST"}).then((function(t){return e.response=t,e.createdOn=(new Date).getTime(),e.expiresIn=t.expires_in,e.refreshToken=t.refreshToken||"",t.scope&&(e.scope=t.scope),t.access_token}))},t.prototype.isExpired=function(){if(!this.token||this.token.length<1)return!0;if(!this.createdOn)return!0;var e=n.safeParseInt(this.expiresIn);return e<=0||!((new Date).getTime()-this.createdOn<1e3*e)},t.prototype.applyTo=function(e){var t=this;e.beforeSend=function(e){e.setRequestHeader("Authorization","Bearer ".concat(t.token))}},t.prototype.applyToV2=function(e){e.headers=e.headers||{},e.headers={Authorization:"Bearer ".concat(this.token)}},t.prototype.applyToV3=function(e){e.requestheaders=e.requestheaders||[],e.requestheaders.push({key:"Authorization",value:"Bearer ".concat(this.token)})},t.prototype.reset=function(){e.prototype.reset.call(this),this.refreshToken="",this.expiresIn=null,this.createdOn=null},t}(A);var U=function(e){function t(){var t=e.call(this,N)||this;return t._openId="",t}return a(t,e),t.prototype.persistent=function(){var t=e.prototype.persistent.call(this);return s(s({},t),{openId:this._openId})},t.prototype.readFrom=function(t){return e.prototype.readFrom.call(this,t),this._openId=t.openId,this},t}(q),V=function(){function e(){}return e.prototype.getTokenInternal=function(){throw new Error("NotImplemented")},e.prototype.applyTo=function(e){},e.prototype.isExpired=function(){return!1},e.prototype.readFrom=function(e){},e.prototype.persistent=function(){},e.prototype.applyToV2=function(e){},e.prototype.applyToV3=function(e){},e.prototype.getTokenP=function(){throw new Error("NotImplemented")},e.prototype.reset=function(){},e}(),B=t.underscore;var G=function(){function e(e){this.authPolicy=e,this._user={},this._security=e}return Object.defineProperty(e.prototype,"asObservable",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.security=function(e){return e&&(this._security=e),this._security},e.prototype.readFrom=function(e){this._user=B.extend(this._user,e)},e.prototype.setUser=function(e){(function e(t,r){if(t===r)return!0;if(null===t||null===r)return t===r;if("object"!=typeof t||"object"!=typeof r)return t===r;if(n.isArray(r)&&n.isArray(t)){if(t.length!==r.length)return!1;for(var o=t.length;o--;)if(!e(t[o],r[o]))return!1}var i={},a=r;for(var o in a)if(a.hasOwnProperty(o)){if(!e(t[o],r[o]))return!1;i[o]=!0}var s=t;for(var o in s)if(s.hasOwnProperty(o)&&!i[o]&&!e(t[o],r[o]))return!1;return!0})(this._user,e)||(this._user=e,this.asObservable.fire("change:user",{data:this._user}))},e.prototype.extendUser=function(e){var t=B.extend({},this._user,e);this.setUser(t)},e.prototype.getUser=function(){return B.extend({},this._user)},e.prototype.subscribe=function(e,t){(void 0===t&&(t=!1),this.asObservable.on("change:user",e),t)&&e({data:this._user})},e.prototype.unSubscribe=function(e){this.asObservable.off("change:user",e)},e.prototype.isUserKnown=function(){return!(!this._user||!this._user.username)},e.prototype.isAuthenticated=function(){return this.authPolicy&&!this.authPolicy.isExpired()},e.ctorParameters=function(){return[{type:void 0}]},e=c([I,u("design:paramtypes",[Object])],e)}(),H=t.jquery;var J=function(e){function t(t){var n=e.call(this,t)||this;return n._antiForgeryKey=t.antiForgeryKey||"__RequestVerificationToken",n._elementTag=t.elementTag||"",n._expired=!0,n}return a(t,e),t.prototype.isExpired=function(){return this._expired},t.prototype.inputField=function(){return'input[name="'+this._antiForgeryKey+'"]'},t.prototype.readFrom=function(e){this.token=e.token},t.prototype.persistent=function(){return{token:this.token}},t.prototype.getTokenInternal=function(){var e,t,r,o=(e=this.url,t=this._elementTag,r=this.inputField(),H.ajax({url:e,dataType:"html text"}).then((function(e){var n,o,i;return o="",n=(new DOMParser).parseFromString(e,"text/html"),t?(i=H(n).find(t)).length>0&&(i=H(n).find(r)).length>0&&(o=(i=i.eq(0)).attr("value")):(i=H(n).find(r)).length>0&&(o=(i=i.eq(0)).attr("value")),o})));n.liftWithGuard(o,(function(e){var t=e&&e.length>0;return this._expired=!t,t}));return o},t.prototype.applyTo=function(e){e.data[this._antiForgeryKey]=this.token},t.prototype.applyToV2=function(e){e.params=e.params||{},e.params[this._antiForgeryKey]=this.token},t.prototype.applyToV3=function(e){},t.prototype.reset=function(){e.prototype.reset.call(this),this._expired=!0},t}(A),L=function(e){function t(t,n){var r=e.call(this,t)||this;return r._payload=s({},n),r}return a(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),t.prototype.getParams=function(){var t=e.prototype.getParams.call(this);return s(s({},t),this._payload)},t}(q);function z(e,t){switch(t.type){case"ADD":var n=t.payload.filter((function(t){return-1===e.items.findIndex((function(e){return t.id===e.id}))}));return s(s({},e),{items:f(e.items,n)});case"REMOVE":var r=e.items.filter((function(e){return-1===t.payload.findIndex((function(t){return e.id===t.id}))}));return s(s({},e),{items:r});case"MODIFY":default:return e}}function W(){return{collection:{items:[]}}}function Y(){return{collection:z}}function X(){var e=new r.ActionsSubject,t=new r.ScannedActionsSubject,n=r.combineReducers,o=new r.ReducerManager(e,{collection:{items:[]}},Y(),n),i=new r.State(e,o,t,{collection:{items:[]}});return new r.Store(i,e,o)}var Q=function(){function e(){}return e.prototype.add=function(e){this.getStore().dispatch({type:"ADD",payload:e})},e.prototype.remove=function(e){this.getStore().dispatch({type:"REMOVE",payload:e})},e.prototype.modify=function(e){this.getStore().dispatch({type:"MODIFY",payload:e})},e}(),Z=function(e){function t(){var t=e.call(this)||this;return t._store=X(),t}return a(t,e),t.prototype.getStore=function(){return this._store},t.prototype.getState=function(){return this._store.select("collection")},t.ɵfac=function(e){return new(e||t)},t.ɵprov=o.ɵɵdefineInjectable({token:t,factory:t.ɵfac}),t}(Q),$=t.when,ee=t.underscore;var te=function(){function e(e){this._providerGenerator=e,this._workingProviders=[]}return e.prototype.hasNextPage=function(){return 0===this._workingProviders.length||(!!this._providerGenerator.hasMore()||ee.some(this._workingProviders,(function(e){return e.hasNextPage()})))},e.prototype.getFirstPage=function(){var e=this;return this._providerGenerator.getNext().then((function(e){return e=ee.filter(e,(function(e){return!(t=e).state.totalPages&&!t.state.totalRecords||t.hasNextPage();var t}))})).then((function(t){e._workingProviders.length=0;var n=ee.map(t,(function(e){var t,n=this;return(t=e,t.state.totalPages||t.state.totalRecords?t.getNextPage():t.getFirstPage()).then((function(t){return n._workingProviders.push(e),t}))}));return $.settle(n)}))},e.prototype.getNextPage=function(){return this.getFirstPage()},e.prototype.reset=function(){this._providerGenerator.reset(),this._workingProviders=[]},e.prototype.forEach=function(e){this._workingProviders.forEach((function(t){t.forEach(e)}))},e.prototype.get=function(e){},e}(),ne=t.backbone,re=t.meld;function oe(e){return re.before(ne,"sync",e)}function ie(e){return re.around(ne,"sync",e)}function ae(e){return re.before(ne,"ajax",e)}var se=t.dataflow,ce=t.backbone,ue=t.underscore,pe={model:1,collection:2,pagedCollection:3},fe={read:"read",create:"create",patch:"patch",update:"update",delete:"delete"},le={},he=[];var de=function(){function e(e){this._cache=new S(300),this._dataflow=new se,this._myEndPointKeys=[],this._host=e.webhost||"",this._uniqueNamePrefix=this._host?this._host.replace(".","-")+"-":"",function(){if(!(he.length>0)){var e=oe((function(e,t,n){if(n.methodKey=e,n.endPointKey=t.endPointKey||(t.collection?t.collection.endPointKey:null),n.endPointKey){var r=le[n.endPointKey].options;"delete"===e?(r.deleteUrl&&(n.url=r.deleteUrl),r.deleteContentType&&(n.contentType=r.deleteContentType)):"update"===e?(r.updateUrl&&(n.url=r.updateUrl),r.updateContentType&&(n.contentType=r.updateContentType)):"create"===e?(r.createUrl&&(n.url=r.createUrl),r.createContentType&&(n.contentType=r.createContentType)):"patch"===e&&(r.patchUrl&&(n.url=r.patchUrl),r.patchContentType&&(n.contentType=r.patchContentType))}}));he.push(e),e=ae((function(e){if(e.endPointKey){var t=le[e.endPointKey].options,r=t.securityDelegate,o=t.extraParams;"application/x-www-form-urlencoded"===t.contentType&&"application/json"===e.contentType?(e.data=JSON.parse(e.data),o&&ue.extend(e.data,o),r&&r(e),e.data=n.urlEncode(e.data),e.contentType=t.contentType):(o&&ue.extend(e.data,o),r&&r(e),"application/x-www-form-urlencoded"===e.contentType&&(e.data=n.urlEncode(e.data)))}})),he.push(e),e=ie((function(e){var t=e.args[2];if(t.endPointKey){var n=le[t.endPointKey],r=n.options;if(r.syncDelegate)return(0,r.syncDelegate)(t.endPointKey,t,n,(function(){return e.proceed()}))}return e.proceed()})),he.push(e)}}()}return Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configurationMapping",{get:function(){return le},enumerable:!0,configurable:!0}),e.prototype.addEndPoint=function(e,t,n){var r=this.configurationMapping,o=this._dataflow,i=this._uniqueNamePrefix+e;if(r[i])throw new Error("Redefined endpoint: "+e);if(r[i]={options:ue.extend(n,{endPointKey:i}),tag:t},this._myEndPointKeys.push(i),t===pe.model)for(var a in fe){if(fe.hasOwnProperty(a))o[e+":"+fe[a]]=1}else o[e+":"+fe.read]=1},e.prototype.getEndPoint=function(e,t){var n=this._cache,r=this._uniqueNamePrefix+e;if(!0!==t){var o=n.get(r);if(o)return o}var i=this.configurationMapping[r];if(!i)throw new Error("No given endpoint is defined for: "+e);var a=null;if(i.tag===pe.model)a=ce.Model.extend(i.options);else if(i.tag===pe.collection)a=ce.Collection.extend(i.options);else{if(i.tag!==pe.pagedCollection)throw new Error("Not implemented");a=ce.PageableCollection.extend(i.options)}return!0!==t&&n.set(r,a,300),a},e.prototype.getConfiguration=function(e){var t=this._uniqueNamePrefix+e;return this.configurationMapping[t]},e.prototype.addWhenCallback=function(e,t){this._dataflow.when(e,t)},e.prototype.addDependency=function(e,t){var n=this._dataflow;n.on(e,(function(){n[t]=n[t]+1}))},e.prototype.cleanupCache=function(){this._cache.reset()},e.prototype.cleanMountedFeatures=function(){he.forEach((function(e){e.remove()})),he.length=0},e.prototype.destroy=function(){this._myEndPointKeys.forEach((function(e){delete le[e]})),this._myEndPointKeys.length=0,this._cache.destroy(),this._cache=null,this._dataflow=null,this._host=null,this._uniqueNamePrefix=null},e}(),ye=window.localStorage,ve=t.underscore,ge=ve.find,_e=ve.findIndex,me=ve.union;function be(e,t){var r=n.defaultValue(t);try{var o=ye.getItem(e);o&&"undefined"!==o&&(o=JSON.parse(o),n.ok(o,t)&&(r=o))}catch(e){console.log(e)}return r}function Pe(e,t,n){void 0===n&&(n=null);try{ye.setItem(e,JSON.stringify(t))}catch(e){console.log(e)}}function we(e,t){try{ye.setItem(e,JSON.stringify(n.defaultValue(t)))}catch(e){console.log(e)}}
/**
     * @fileOverview
     * Encapsulates the local storage service into one
     * providing prmoise-aware services.
     * @name LocalStorageTable.js
     * @module hypercom/storage/LocalStorageTable
     * @author Xiaolong Tang <xxlongtang@gmail.com>
     * @license Copyright @me
     */
var xe=function(){function e(){}return e.prototype.getP=function(e){var t=be(e,n.tyObject);return n.lift(t,null)},e.prototype.removeP=function(e){return we(e,n.tyObject),n.lift(!0,null)},e.prototype.updateP=function(e,t){return Pe(e,t,n.tyObject),n.lift(!0,null)},e}(),Oe=t.I18n,Ee=function(){function e(){}return e.getDictByCode=function(e){return Oe.data[e]},e.add=function(e,t){Oe.add(e,t)},e.translate=function(e,t){var n=Oe.translate(e);return n===e&&t?t:n},e.recycleOthers=function(e){var t=Oe.data,n=[];for(var r in t)t.hasOwnProperty(r)&&r!==e&&n.push(r);for(var o=0;o<n.length;o++){delete t[n[o]]}},e}();
/**
     * @fileOverview
     * Provides i18n service. This module is designed as
     * a delegate of the tinymce I18n service.
     * @author Xiaolong Tang <xxlongtang@gmail.com>
     * @license Copyright @me
     */t.underscore.isString;function ke(e,t,n){void 0===n&&(n=1);var r=t.slice(n).join(".");if(e[r])return e[r];for(var o=e,i=n;i<t.length&&o;i++){o=o[t[i]]}return o}var Te=function(){function e(e){void 0===e&&(e=null),this._cache=e,this._configuration={}}return e.prototype.register=function(e,t,n){void 0===n&&(n=60);var r=this._configuration;if(r[e])throw new Error("Registering an existing resource key: "+e);r[e]={uri:t,liveSeconds:n}},e.prototype.undoRegister=function(e){var t=this._configuration;t[e]&&delete t[e]},e.prototype.getPromise=function(e,t){var r=e.split("."),o=r[0],i=this._cache;if(i){var a=i.get(o,60);if(a){var s=ke(a,r);if(s)return n.lift(s,null)}}var c=this._configuration[o];if(!c)throw new Error("Get unregistered resource: "+o);return O(c.uri).then((function(e){return e=t(e),i&&i.set(o,e,c.liveSeconds),ke(e,r)}))},e}();e.AggregateCollection=te,e.AntiForgeryKeyPolicy=J,e.CollectionAbstractStore=Q,e.CollectionStore=Z,e.DummyOAuthTokenCtorParams=N,e.DummyRecords=g,e.GlobalProvider=de,e.I18n=Ee,e.LocalStorageTable=xe,e.MemoryBackend=E,e.NullPolicy=V,e.OAuthTokenExtPolicy=L,e.OAuthTokenPolicy=q,e.OpenIDPolicy=U,e.PolicyBase=A,e.RelationDatabase=_,e.RelationalTable=y,e.ResourceLoader=Te,e.SlidingExpirationCache=S,e.UserCredential=G,e.adaptToOAuthToken=M,e.adaptToOpenIDToken=function(e){var t=M(e=e||{});return s(s({},t),{openId:e.openId||""})},e.buildInitialState=W,e.buildReducerMap=Y,e.cleanEntity=we,e.cleanEntityGroup=function(e){var t=[];for(var n in ye)ye.hasOwnProperty(n)&&0===n.indexOf(e)&&t.push(n);return 0===t.length||t.forEach((function(e){ye.removeItem(e)})),t},e.endPointEnum=pe,e.factory=X,e.findEntityById=function(e,t){var r=be(e,n.tyArray);return ge(r,{Id:t})},e.getEntity=be,e.insertEntities=function(e,t,r){var o=be(e,n.tyArray);Pe(e,r>0&&o.length>r?t:me(o,t),n.tyArray)},e.insertOrUpdateEntity=function(e,t){var r=be(e,n.tyArray),o=_e(r,{Id:t.Id});-1!==o?r[o]=t:r.push(t),Pe(e,r,n.tyArray)},e.loadHtmlP=function(e){return x.ajax({url:e,dataType:"html text"}).then((function(e){var t=(new DOMParser).parseFromString(e,"text/html");return x(t)}))},e.loadJsonUriP=O,e.mountAjaxBeforeAdvice=ae,e.mountSyncAroundAdvice=ie,e.mountSyncBeforeAdvice=oe,e.mountSyncListener=function(e){return[re.before(ne.Collection.prototype,"trigger",e),re.before(ne.Model.prototype,"trigger",e)]},e.observableDecorator=I,e.pingP=function(e,t){t=t||{};var n=w.extend({url:e},t);return x.ajax(n)},e.reducer=z,e.removeEntityById=function(e,t){var r=be(e,n.tyArray),o=_e(r,{Id:t});-1!==o&&(r.splice(o,1),Pe(e,r,n.tyArray))},e.sendPromise=function(e){var t=b.extend({},P,e);return new Promise((function(e,r){var o={url:t.url,content_type:t.content_type,response_type:t.response_type,type:t.type,data:t.data,async:t.async,success:function(t,n,r){e({response:t,xhr:n,settings:r})},error:function(e,t,n){r({error:e,xhr:t,settings:n})},success_scope:t.success_scope,error_scope:t.error_scope,scope:t.scope,requestheaders:t.requestheaders};"application/x-www-form-urlencoded"===t.content_type?o.data=n.urlEncode(o.data):"application/json"===t.content_type&&(o.data=JSON.stringify(o.data)),m.send(o)}))},e.syncMethodEnum=fe,e.updateEntity=Pe,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=polpware-fe-data.umd.min.js.map